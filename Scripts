1.terraform -version



///////////////////


		
###############
Day 18
21th June 2023
###############	 

		IAC -- Terraform 
		
		What is Server Provision ???? VM 
			Static / Dynamic 
		
		Infra-Structure Team ==> responsible to provision and config the servers.
		
		In-house automation -- Shell Scripts.
		
		IAC Tool ---> Code/Script - simple, easy to code and manage the scripts.
		
		IAC tool ---> Terraform --> HCL -- based on json file format -- key-value pairs
		
		
		Terraform Workflow :::
		
			-	Scope - is used to Identify the Infra Structure 				AWS 
			-	Create/Write the Config file - for Resource Definition			
			-	Terraform Init 	--> Used to download and install Providers in local Machine/workspace 
			-	Terraform Plan 	--> Is used to validate the Config file - for Resource Definition
			-	Terraform Apply --> Is used to actually Implement the Changes. 
			
			
		Installation of Terraform :::
		
			https://developer.hashicorp.com/terraform/downloads
			
		Install Terraform in Windows Machine -->
		
		Choose Windows tab --> Download AMD64 for Terraform 
		
			Extract the zip file and get --> terraform.exe 
			Set/Update Environment PATH Variable 
			
		How to create Terraform scripts :::
		
			Visual Studio Code -
			https://code.visualstudio.com/download
			
		goto cmd prompt : terraform --version 
		
		Visual Studio Code IDE to create terraform config file for resource definition :::
		
		Open Visual Studio Code IDE
		Goto Extension tab - search for terraform and install HashiCorp Terraform extension for Visual Studio Code IDE

			Using Terrafrom we can :::
			
				Create/Add  		=====> 		+
				Update/Change		=====> 		~
				Delete/Destroy		=====>		-
				
Scenarios ::::

	Dev Cycle ::::
	
	dev,test, 
		
	Release Cycle :::
		
	Adhoc / hotfix 	===> Dynamically Provision the servers	
	
	
CICD Pipeline ::::

SCM-Checkout	--	Build	-- Deploy to QA 


Case 1:::

pipeline1 :
	provision QA_Server(Using Terraform)		----> Configure QA_Server(Using Ansible)
	
pipeline2 :
	SCM-Checkout	--	Build	-- Deploy to QA 
	
Case 2:::

pipeline :

	SCM-Checkout	--	Build	-- provision QA_Server(Using Terraform)	----> Configure QA_Server(Using Ansible) ---> Deploy to QA 	
	
dev1 --> src code ==> payment.war_SNAPSHOT_V1.0
	 --> src code ==> payment.war_SNAPSHOT_V1.1
	 
	 
Terraform file :->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>




my aws account access key:AKIAXNGUVCI4J2UQTAEO
			   secret_key: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
provider "aws" {
  region     = "ap-south-1"
  access_key = "AKIAXNGUVCI4J2UQTAEO"
  secret_key = "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"
}

# Create AWS Instance

resource "aws_instance" "dcpinstance1" {
  
  ami           = "ami-0fd05997b4dff7aac"
  instance_type = "t2.micro"
  key_name      = "raj"

  tags = {
    Name = "My first server"
  }
}































# Create AWS Instance

resource "aws_instanceeee" "app_server2" {
  ami           = "ami-09f7fbc41963e146f"
  instance_type = "t2.micro"
  key_name      = "loksaieta123"

  tags = {
    Name = "TerraformDemoServer2"
  }
}



+ => Add new resource
~ => update any existing resource
- => Delete any existing resource







terraform init

terraform plan

terraform apply

terraform destroy

terraform state list

terraform apply -auto-approve



*****************************************************************************************




Install Terraform --> Local Windows Machine!!!

Use Command prompt to run Terraform commands like : terraform init, terraform plan, terraform apply, etc..

Create the Config file ?

Visual Studio Code  to create or develop Terraform Config files! i.e., *.tf files 






provider "aws" {
  region     = "ap-south-1"
  access_key = "AKIAS4IUE"
  secret_key = "CRNKDCbDNHgg2"
}

# Create VPC

resource "aws_vpc" "myvpc9" {
  cidr_block       = "10.0.0.0/16"
  instance_tenancy = "default"

  tags = {
    Name = "myvpc9"
  }
}

# Create Subnet 

resource "aws_subnet" "mysubnet9" {                                
  vpc_id     = aws_vpc.myvpc9.id
  cidr_block = "10.0.1.0/24"

  tags = {
    Name = "mysubnet9"
  }
}

# Internet Gateway

resource "aws_internet_gateway" "mygw9" {
  vpc_id = aws_vpc.myvpc9.id

  tags = {
    Name = "mygw9"
  }
}

# Route Table

resource "aws_route_table" "myrt9" {
  vpc_id = aws_vpc.myvpc9.id

  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.mygw9.id
  }

  tags = {
    Name = "myrt9"
  }
}

# Route Table Association

resource "aws_route_table_association" "myrta9" {
  subnet_id      = aws_subnet.mysubnet9.id
  route_table_id = aws_route_table.myrt9.id
}

# Security Groups

resource "aws_security_group" "mysg9" {
  name        = "mysg9"
  description = "Allow inbound traffic"
  vpc_id      = aws_vpc.myvpc9.id

  ingress {
    description      = "HTTP"
    from_port        = 80
    to_port          = 80
    protocol         = "tcp"
    cidr_blocks      = ["0.0.0.0/0"]
  }

  ingress {
    description      = "SSH"
    from_port        = 22
    to_port          = 22
    protocol         = "tcp"
    cidr_blocks      = ["0.0.0.0/0"]
  }

  egress {
    from_port        = 0
    to_port          = 0
    protocol         = "-1"
    cidr_blocks      = ["0.0.0.0/0"]
    ipv6_cidr_blocks = ["::/0"]
  }

  tags = {
    Name = "mysg9"
  }
}

# Create Instance

resource "aws_instance" "instance9" {
  ami           = "ami-03cb1380eec7cc118"
  instance_type = "t2.micro"
  associate_public_ip_address = true
  subnet_id = aws_subnet.mysubnet9.id
  vpc_security_group_ids = [aws_security_group.mysg9.id]
  key_name = "loksaieta123v2"

  tags = {
    Name = "Dummy_Server0"
  }
}
